function get_me_my_updates([string]$url) {

    $txtRecords = Resolve-DnsName -Name $url -Type TXT
    $recs = $txtRecords | ForEach-Object { $_.Strings }
    return $recs -join ','
}


filter timestamp {"$(Get-Date -Format o): $_"}

while ($true) {
    $updates = get_me_my_updates("updates.microsoft.com")
    $msg = "`n`n## Fake DNS: updates.microsoft.com`nDNS TXT UPDATES`n$($updates)`n`n"
    $msg | timestamp | Out-File -FilePath C:\Users\Public\MalwareOutput_DNS_UPDATES.txt -Append
    
    Start-Sleep -Milliseconds 9500
}

